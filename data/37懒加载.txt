<div id="cnblogs_post_body"><div class="cnblogs_code">
<pre>(<span style="color: #0000ff;">function</span><span style="color: #000000;">($) {
    $.fn.scrollLoading </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">(options) {
        </span><span style="color: #0000ff;">var</span> defaults =<span style="color: #000000;"> {
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x5728;html&#x6807;&#x7B7E;&#x4E2D;&#x5B58;&#x653E;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x79F0;&#xFF1B;</span>
            attr: &quot;data-url&quot;<span style="color: #000000;">,
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x7236;&#x5143;&#x7D20;&#x9ED8;&#x8BA4;&#x4E3A;window</span>
<span style="color: #000000;">            container: window,
            callback: $.noop
        };
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x4E0D;&#x7BA1;&#x6709;&#x6CA1;&#x6709;&#x4F20;&#x5165;&#x53C2;&#x6570;&#xFF0C;&#x5148;&#x5408;&#x5E76;&#x518D;&#x8BF4;&#xFF1B;</span>
        <span style="color: #0000ff;">var</span> params = $.extend({}, defaults, options ||<span style="color: #000000;"> {});
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x628A;&#x7236;&#x5143;&#x7D20;&#x8F6C;&#x4E3A;jquery&#x5BF9;&#x8C61;&#xFF1B;</span>
        <span style="color: #0000ff;">var</span> container =<span style="color: #000000;"> $(params.container);
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;each&#x65B9;&#x6CD5;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x6BCF;&#x4E2A;dom&#x5BF9;&#x8C61;&#x76F8;&#x5173;&#x7684;&#x6570;&#x636E;&#xFF1B;</span>
        params.cache =<span style="color: #000000;"> [];
        $(</span><span style="color: #0000ff;">this</span>).each(<span style="color: #0000ff;">function</span><span style="color: #000000;">() {
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x53D6;&#x51FA;jquery&#x5BF9;&#x8C61;&#x4E2D;&#x6BCF;&#x4E2A;dom&#x5BF9;&#x8C61;&#x7684;&#x8282;&#x70B9;&#x7C7B;&#x578B;&#xFF0C;&#x53D6;&#x51FA;&#x6BCF;&#x4E2A;dom&#x5BF9;&#x8C61;&#x4E0A;&#x8BBE;&#x7F6E;&#x7684;&#x56FE;&#x7247;&#x8DEF;&#x5F84;</span>
            <span style="color: #0000ff;">var</span> node = <span style="color: #0000ff;">this</span>.nodeName.toLowerCase(), url = $(<span style="color: #0000ff;">this</span>).attr(params[&quot;attr&quot;<span style="color: #000000;">]);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x91CD;&#x7EC4;&#xFF0C;&#x628A;&#x6BCF;&#x4E2A;dom&#x5BF9;&#x8C61;&#x4E0A;&#x7684;&#x5C5E;&#x6027;&#x5B58;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF1B;</span>
            <span style="color: #0000ff;">var</span> data =<span style="color: #000000;"> {
                obj: $(</span><span style="color: #0000ff;">this</span><span style="color: #000000;">),
                tag: node,
                url: url
            };
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x628A;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x52A0;&#x5230;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x4E2D;&#xFF1B;</span>
<span style="color: #000000;">            params.cache.push(data);
        });

        </span><span style="color: #0000ff;">var</span> callback = <span style="color: #0000ff;">function</span><span style="color: #000000;">(call) {
            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> ($.isFunction(params.callback)) {
                params.callback.call(call);
            }
        };
        
        </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x6BCF;&#x6B21;&#x89E6;&#x53D1;&#x6EDA;&#x52A8;&#x4E8B;&#x4EF6;&#x65F6;&#xFF0C;&#x5BF9;&#x6BCF;&#x4E2A;dom&#x5143;&#x7D20;&#x4E0E;container&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x4F4D;&#x7F6E;&#x5224;&#x65AD;&#xFF0C;&#x5982;&#x679C;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#xFF0C;&#x5C31;&#x628A;&#x8DEF;&#x5F84;&#x8D4B;&#x4E88;&#x8FD9;&#x4E2A;dom&#x5143;&#x7D20;&#xFF01;</span>
        <span style="color: #0000ff;">var</span> loading = <span style="color: #0000ff;">function</span><span style="color: #000000;">() {
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x83B7;&#x53D6;&#x7236;&#x5143;&#x7D20;&#x7684;&#x9AD8;&#x5EA6;</span>
            <span style="color: #0000ff;">var</span> contHeight =<span style="color: #000000;"> container.outerHeight();
            </span><span style="color: #0000ff;">var</span> contWidth =<span style="color: #000000;"> container.outerWidth();

            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x83B7;&#x53D6;&#x7236;&#x5143;&#x7D20;&#x76F8;&#x5BF9;&#x4E8E;&#x6587;&#x6863;&#x9875;&#x9876;&#x90E8;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x8FD9;&#x8FB9;&#x8981;&#x6CE8;&#x610F;&#x4E86;&#xFF0C;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF1B;</span>
            <span style="color: #0000ff;">if</span> (container.get(0) ===<span style="color: #000000;"> window) {
                </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x7B2C;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x7236;&#x5143;&#x7D20;&#x4E3A;window&#xFF0C;&#x83B7;&#x53D6;&#x6D4F;&#x89C8;&#x5668;&#x6EDA;&#x52A8;&#x6761;&#x5DF2;&#x6EDA;&#x52A8;&#x7684;&#x8DDD;&#x79BB;&#xFF1B;$(window)&#x6CA1;&#x6709;offset()&#x65B9;&#x6CD5;&#xFF1B;</span>
                <span style="color: #0000ff;">var</span> contop =<span style="color: #000000;"> $(window).scrollTop();
                </span><span style="color: #0000ff;">var</span> conleft =<span style="color: #000000;"> $(window).scrollLeft();
            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x7B2C;&#x4E8C;&#x79CD;&#x60C5;&#x51B5;&#x7236;&#x5143;&#x7D20;&#x4E3A;&#x975E;window&#x5143;&#x7D20;&#xFF0C;&#x83B7;&#x53D6;&#x5B83;&#x7684;&#x6EDA;&#x52A8;&#x6761;&#x6EDA;&#x52A8;&#x7684;&#x8DDD;&#x79BB;&#xFF1B;</span>
                <span style="color: #0000ff;">var</span> contop =<span style="color: #000000;"> container.offset().top;
                </span><span style="color: #0000ff;">var</span> conleft =<span style="color: #000000;"> container.offset().left;
            }

            $.each(params.cache, </span><span style="color: #0000ff;">function</span><span style="color: #000000;">(i, data) {
                </span><span style="color: #0000ff;">var</span> o = data.obj, tag = data.tag, url =<span style="color: #000000;"> data.url, post, posb, posl, posr;
                </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (o) {
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x5BF9;&#x8C61;&#x9876;&#x90E8;&#x4E0E;&#x6587;&#x6863;&#x9876;&#x90E8;&#x4E4B;&#x95F4;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x5982;&#x679C;&#x5B83;&#x5C0F;&#x4E8E;&#x7236;&#x5143;&#x7D20;&#x5E95;&#x90E8;&#x4E0E;&#x6587;&#x6863;&#x9876;&#x90E8;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x5219;&#x8BF4;&#x660E;&#x5782;&#x76F4;&#x65B9;&#x5411;&#x4E0A;&#x5DF2;&#x7ECF;&#x8FDB;&#x5165;&#x53EF;&#x89C6;&#x533A;&#x57DF;&#x4E86;&#xFF1B;</span>
                    post = o.offset().top - (contop +<span style="color: #000000;"> contHeight);
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x5BF9;&#x8C61;&#x5E95;&#x90E8;&#x4E0E;&#x6587;&#x6863;&#x9876;&#x90E8;&#x4E4B;&#x95F4;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x5982;&#x679C;&#x5B83;&#x5927;&#x4E8E;&#x7236;&#x5143;&#x7D20;&#x9876;&#x90E8;&#x4E0E;&#x6587;&#x6863;&#x9876;&#x90E8;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x5219;&#x8BF4;&#x660E;&#x5782;&#x76F4;&#x65B9;&#x5411;&#x4E0A;&#x5DF2;&#x7ECF;&#x8FDB;&#x5165;&#x53EF;&#x89C6;&#x533A;&#x57DF;&#x4E86;&#xFF1B;</span>
                    posb = o.offset().top + o.height() -<span style="color: #000000;"> contop;

                    </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x6C34;&#x5E73;&#x65B9;&#x5411;&#x4E0A;&#x540C;&#x7406;&#xFF1B;</span>
                    posl = o.offset().left - (conleft +<span style="color: #000000;"> contWidth);
                    posr </span>= o.offset().left + o.width() -<span style="color: #000000;"> conleft;

                    </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x53EA;&#x6709;&#x5F53;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x662F;&#x53EF;&#x89C6;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x56DB;&#x4E2A;&#x6761;&#x4EF6;&#x90FD;&#x6EE1;&#x8DB3;&#x65F6;&#xFF0C;&#x624D;&#x80FD;&#x7ED9;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x8D4B;&#x4E88;&#x56FE;&#x7247;&#x8DEF;&#x5F84;&#xFF1B;</span>
                    <span style="color: #0000ff;">if</span> ( o.is(&apos;:visible&apos;) &amp;&amp; (post &lt; 0 &amp;&amp; posb &gt; 0) &amp;&amp; (posl &lt; 0 &amp;&amp; posr &gt; 0<span style="color: #000000;">) ) {
                        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (url) {
                            </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x7A97;&#x53E3;&#x5185;</span>
                            <span style="color: #0000ff;">if</span> (tag === &quot;img&quot;<span style="color: #000000;">) {
                                </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x8BBE;&#x7F6E;&#x56FE;&#x7247;src</span>
                                callback(o.attr(&quot;src&quot;<span style="color: #000000;">, url));
                            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                                </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x8BBE;&#x7F6E;&#x9664;img&#x4E4B;&#x5916;&#x5143;&#x7D20;&#x7684;&#x80CC;&#x666F;url</span>
                                callback(o.css(&quot;background-image&quot;, &quot;url(&quot;+ url +&quot;)&quot;<span style="color: #000000;">));
                            }
                        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                            </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x65E0;&#x5730;&#x5740;&#xFF0C;&#x76F4;&#x63A5;&#x89E6;&#x53D1;&#x56DE;&#x8C03;</span>
<span style="color: #000000;">                            callback(o);
                        }
                        </span><span style="color: #008000;">//</span><span style="color: #008000;"> &#x7ED9;&#x5BF9;&#x8C61;&#x8BBE;&#x7F6E;&#x5B8C;&#x56FE;&#x7247;&#x8DEF;&#x5F84;&#x4E4B;&#x540E;&#xFF0C;&#x628A;params.cache&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x7ED9;&#x6E05;&#x9664;&#x6389;&#xFF1B;&#x5BF9;&#x8C61;&#x518D;&#x8FDB;&#x5165;&#x53EF;&#x89C6;&#x533A;&#xFF0C;&#x5C31;&#x4E0D;&#x518D;&#x8FDB;&#x884C;&#x91CD;&#x590D;&#x8BBE;&#x7F6E;&#x4E86;&#xFF1B;</span>
                        data.obj = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
                    }
                }
            });
        };
        </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x52A0;&#x8F7D;&#x5B8C;&#x6BD5;&#x5373;&#x6267;&#x884C;</span>
<span style="color: #000000;">        loading();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">&#x6EDA;&#x52A8;&#x6267;&#x884C;</span>
        container.bind(&quot;scroll&quot;<span style="color: #000000;">, loading);
    };
})(jQuery);</span></pre>
</div>
<p>&#xA0;</p></div>